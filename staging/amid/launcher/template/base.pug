doctype html
html
  head
    meta(charset='UTF-8')
    title  wScriptLauncher
    block scripts
      script(src='launcher/node_modules/wTools/staging/abase/wTools.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/aKernel.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/akernelWithComponents.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/cFieldFilter.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/cFieldMapper.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/eNameTools.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/eExecTools.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/eStringTools.s')
      script(src='launcher/node_modules/wTools/staging/abase/akernel/eInclude.s')
      script(src='launcher/node_modules/wProto/staging/abase/component/Proto.s')
      script(src='launcher/node_modules/winstancing/staging/abase/mixin/Instancing.s')
      script(src='launcher/node_modules/wPath/staging/abase/component/Path.s')
      script(src='launcher/node_modules/wcloner/staging/abase/component/Cloner.s')
      script(src='launcher/node_modules/wCopyable/staging/abase/mixin/Copyable.s')
      script(src='launcher/node_modules/wConsequence/staging/abase/syn/Consequence.s')
      script(src='launcher/node_modules/wColor/staging/amid/color/Color.s')
      script(src='launcher/node_modules/wLogger/staging/abase/printer/PrinterBase.s')
      script(src='launcher/node_modules/wLogger/staging/abase/printer/PrinterMid.s')
      script(src='launcher/node_modules/wLogger/staging/abase/printer/aChainingMixin.s')
      script(src='launcher/node_modules/wLogger/staging/abase/printer/aColoredMixin.s')
      script(src='launcher/node_modules/wLogger/staging/abase/printer/PrinterTop.s')
      script(src='launcher/node_modules/wLogger/staging/abase/printer/printer/Logger.s')
      script(src='launcher/node_modules/socket.io-client/dist/socket.io.js')
      script(src='launcher/node_modules/wloggertoserver/staging/abase/printer/printer/ToServer.s')
      script.
            var _ = wTools;
            _.io = io;
            var script = #{script}
            var port = #{port}
            var url = 'http://localhost:' + port;
            wLogger.rawOutput = true;
            var l = new wLoggerToServer();
            l.permanentStyle = { bg : 'yellow', fg : 'black' };
            // wLogger.consoleBar
            // ({
            //   outputLogger : l,
            //   bar : 1
            // });
            l.inputFrom( console );
            l.connect()
            .doThen( () => script() )
            .doThen( () => l.disconnect() )
            .doThen( function ()
            { 
              var socket = _.io( url );
              socket.on( 'connect', function()
              {
                socket.emit( 'terminate', '' );
                socket.disconnect();
              });
            });
            
body
    
